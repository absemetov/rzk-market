<nav aria-label="breadcrumb">
  <ol class="breadcrumb">
    <li class="breadcrumb-item"><a href="/">{{envSite.i18n.aObjects}}</a></li>
    <li class="breadcrumb-item"><a href="/o/{{object.id}}">{{object.name}}</a></li>
    <li class="breadcrumb-item active" aria-current="page">{{envSite.i18n.aCart}}</li>
  </ol>
</nav>
{{#if products}}
  <div class="row row-cols-2 row-cols-sm-2 row-cols-md-3 row-cols-lg-4 g-2 pb-3">
  {{#each products as |product|}}
    {{> product product=product object=../object envSite=../envSite}}
  {{/each}}
  </div>
  <div class="row">
    <div class="col">
      <h5>{{envSite.i18n.tQty}}: <strong id="totalQty">{{object.cartInfo.totalQty}}</strong></h5>
    </div>
  </div>
  <div class="row">
    <div class="col">
      <h5>{{envSite.i18n.tSum}}: <strong class="text-nowrap" id="totalSum">{{object.cartInfo.totalSum}} {{envSite.currency}}</strong></h5>
    </div>
  </div>
  <button type="button" class="btn btn-success mt-2" data-bs-toggle="modal" data-bs-target="#purchaseModal">
    {{envSite.i18n.btnPurchase}}
  </button>
{{else}}
  <h3>{{envSite.i18n.tCartEmpty}} <a href="/o/{{object.id}}/c">{{envSite.i18n.aChuseGoods}}</a></h3>
{{/if}}
<!-- Modal purchase -->
<div class="modal fade" id="purchaseModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">{{envSite.i18n.modalPurchase.title}}</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form id="purchase" action="/o/{{object.id}}/cart/purchase">
          {{#unless envSite.user.auth}}
            <div class="alert alert-warning alert-dismissible fade show" role="alert">
              <a href="/login?r={{object.id}}"><i class="bi bi-person-circle"></i> {{envSite.i18n.aLoginTelegram}}</a>
              <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
          {{/unless}}
          <div class="mb-3">
            <label for="lastName" class="form-label">{{envSite.i18n.modalPurchase.lastName}}</label>
            <input type="text" class="form-control" name="lastName" id="lastName" aria-describedby="lastName" required autofocus>
          </div>
          <div class="mb-3">
            <label for="firstName" class="form-label">{{envSite.i18n.modalPurchase.firstName}}</label>
            <input type="text" class="form-control" name="firstName" id="firstName" aria-describedby="firstName" required>
          </div>
          <div class="mb-3">
            <label for="phoneNumber" class="form-label">{{envSite.i18n.modalPurchase.phoneNumber}}</label>
            <input type="tel" pattern="{{envSite.phoneregexp}}" title="{{envSite.phonetemplate}}" class="form-control" name="phoneNumber" id="phoneNumber" aria-describedby="phoneNumber" required>
          </div>
          <div class="mb-3">
            <label for="address" class="form-label">{{envSite.i18n.modalPurchase.address}}</label>
            <input type="text" class="form-control" name="address" id="address" aria-describedby="address" required>
          </div>
          <div class="mb-3">
            <label for="carrierId" class="form-label">{{envSite.i18n.modalPurchase.carrier}}</label>
            <select name="carrierId" id="carrierId" class="form-select" aria-label="carrierId">
              {{#each carriers as |carrier|}}
                <option value="{{carrier.id}}" data-bs-reqnumber="{{carrier.reqNumber}}">{{carrier.name}}</option>
              {{/each}}
            </select>
          </div>
          <div class="mb-3" id="carrierNumberDiv">
            <label for="carrierNumber" class="form-label">{{envSite.i18n.modalPurchase.carrierNumber}}</label>
            <input type="number" min="1" class="form-control" name="carrierNumber" id="carrierNumber" aria-describedby="carrierNumberFeedback">
            <div id="carrierNumberFeedback" class="invalid-feedback"></div>
          </div>
          <div class="mb-3">
            <label for="paymentId" class="form-label">{{envSite.i18n.modalPurchase.payment}}</label>
            <select name="paymentId" id="paymentId" class="form-select" aria-label="paymentId">
              {{#each payments as |payment|}}
                <option value="{{payment.id}}">{{payment.name}}</option>
              {{/each}}
            </select>
          </div>
          <div class="mb-3">
            <label for="comment" class="form-label">{{envSite.i18n.modalPurchase.comment}}</label>
            <textarea class="form-control" id="comment" name="comment" rows="3"></textarea>
          </div>
          <button type="submit" id="createOrderButton" class="btn btn-success">{{envSite.i18n.btnPurchaseConfirm}}</button>
        </form>
      </div>
    </div>
</div>